```ruby
ä¾‹ï¼š
è¾“å…¥ï¼š
apple
apple
zz
ww
qq
o
ddd
ddd
è¾“å‡ºï¼š
apple 25.00%
ddd 25.00%
o 12.50%
qq 12.50%
ww 12.50%
zz 12.50%

#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

typedef struct node
{
    char name[30];      //è®°å½•å…³é”®å­—å­—ç¬¦ä¸²
	int balance ;			//å¹³è¡¡å› å­
	int count ;			//å‡ºç°æ¬¡æ•°
    struct node *lchild ;	//å·¦å­©å­
	struct node *rchild ;	//å³å­©å­
}treenode, *avl;

int n ;  				//æ‰€æœ‰æ ‘ç§å‡ºç°çš„æ€»æ¬¡æ•°

treenode *create(char *key) ;  //å‡ºç°æ–°çš„æ ‘ç§ï¼Œåœ¨äºŒå‰æ ‘ä¸Šç”Ÿæˆä¸€ä¸ªæ–°ç»“ç‚¹
int height( avl tree ) ;  //ç”¨äºè®¡ç®—å¹³è¡¡æ·±åº¦
avl insertt( char *key , avl tree ) ;  //æŸ¥æ‰¾äºŒå‰æ ‘ä¸Šçš„æ ‘ç§åç§°å¹¶è®¡æ•°
void InOrder( avl tree ); //ä¸­åºéå†äºŒå‰æ ‘ï¼Œå¹¶è¾“å‡ºæ ‘ç§åŠæ‰€å æ¯”ä¾‹
avl LL( avl tree ) ;  //å·¦å•æ—‹è½¬
avl RR( avl tree ) ;  //å³å•æ—‹è½¬
avl LR( avl tree ) ;  //å·¦å³åŒæ—‹
avl RL( avl tree ) ;  //å³å·¦åŒæ—‹

treenode *create(char *key)
{
    treenode *tree = new treenode;  //ç”³è¯·æ–°ç»“ç‚¹
	strcpy( tree->name , key);  //å¤åˆ¶ç»™æ–°å¼€è¾Ÿçš„ç»“ç‚¹
	tree->balance = 0;  //æ­¤æ—¶å¹³è¡¡å› å­ä¸º0
	tree->count = 1;   //æ ‘ç§ä¸ªæ•°ä¸º1
	tree->lchild = NULL;  //æ­¤æ—¶å·¦å­©å­å’Œå³å­©å­éƒ½ä¸å­˜åœ¨
	tree->rchild = NULL;
    return tree;
}

int height( avl tree ) 
{
    if( tree == NULL ) //å¦‚æœè¿™ä¸ªèŠ‚ç‚¹ä¸ºç©ºï¼Œé‚£ä¹ˆè¿”å›çš„æ·±åº¦å°±æ˜¯-1
    {
	    return -1 ;
    }
    return tree->balance ;
}

avl insertt( char *key , avl tree )
{
    if( tree == NULL )  //å¦‚æœäºŒå‰æ ‘ä¸­æ²¡æœ‰è¿™ä¸ªæ ‘ç§ï¼Œåˆ™æ’å…¥æ–°ç»“ç‚¹
    {
        avl node = create( key );
        tree = node ;
    }
    else if( strcmp ( tree->name , key ) ==0 )  // æ–°å‘ç°çš„æ ‘ç§åœ¨äºŒå‰æ ‘ä¸­æ‰¾åˆ°ç›¸åº”çš„æ ‘ç§
    {
 	   tree->count ++ ;  //åˆ™è¯¥æ ‘æ•°ç›®åŠ ä¸€
	}
    else if( strcmp ( key , tree->name ) < 0 )  //å¦‚æœæ–°å‘ç°çš„æ ‘ç§åæ¯”å½“å‰ç»“ç‚¹æ•°å°ï¼Œé‚£ä¹ˆå‘å·¦å­æ ‘å¯»æ‰¾   
    {
        tree->lchild = insertt( key , tree->lchild ) ;  
        if( height( tree->lchild ) - height( tree->rchild ) == 2 ) //å¦‚æœä¸å¹³è¡¡ 
        {    
	    if( strcmp ( key , tree->lchild->name ) < 0 ) //åŠ åˆ°å·¦å­æ ‘ä¸­ï¼Œè¿›è¡Œå·¦å•æ—‹
	    {
	        tree = LL( tree ) ;
     	    }
	    else  //åŠ åˆ°å³å­æ•°ä¸­ï¼Œè¿›è¡Œå·¦å³åŒæ—‹
   	    {                        
	    	tree = LR( tree ) ;
	    }
	}
    }
    else if( strcmp ( key , tree->name ) > 0 ) // å¦‚æœæ–°å‘ç°çš„æ ‘ç§åæ¯”å½“å‰ç»“ç‚¹æ•°å¤§ï¼Œé‚£ä¹ˆå‘å³å­æ ‘å¯»æ‰¾
    {
        tree->rchild = insertt ( key , tree->rchild ) ;
        if ( height( tree->lchild ) - height( tree->rchild) == -2 )  //å¦‚æœä¸å¹³è¡¡
        {
            if ( strcmp ( key , tree->rchild->name ) > 0 )  // åŠ åˆ°å³å­æ ‘ä¸­ï¼Œè¿›è¡Œå³å•æ—‹
            {
	        tree = RR ( tree ) ;
            }
            else     //åŠ åˆ°å·¦å­æ ‘ä¸­ï¼Œè¿›è¡Œå³å·¦åŒæ—‹
            {
	        tree = RL ( tree ) ;
            }
        }
    }
    tree->balance = max ( height( tree->lchild) , height( tree->rchild) ) + 1 ; //è°ƒæ•´æ ‘çš„é«˜åº¦
    return tree ;
}
void InOrder( avl tree )
{
    if( tree != NULL )        //æŒ‰ç…§ä¸­åºéå†è¾“å‡º
    {
        InOrder ( tree->lchild ) ;
        printf ( "%s %.2f%%\n" , tree->name , ( (double ) ( tree->count ) / ( double ) n ) * 100 ) ;  
        InOrder ( tree->rchild ) ;
    }
}

avl LL( avl tree )   //LLå‹çš„ä¸å¹³è¡¡ç»“ç‚¹è¿›è¡Œå·¦å•æ—‹è½¬
{
    avl temp ;
    temp = tree->lchild ;
    tree->lchild = temp->rchild ;
    temp->rchild = tree ;
    tree->balance = max( height( tree->lchild ) , height(tree->rchild ) ) + 1 ;  //æ—‹è½¬åé‡æ–°è°ƒæ•´æ ‘çš„é«˜åº¦
    temp->balance = max( height( temp->lchild ) , tree->balance ) + 1 ;
    return temp ;
}

avl RR( avl tree )   //RRå‹çš„ä¸å¹³è¡¡ç»“ç‚¹å¤„è¿›è¡Œå³å•æ—‹è½¬
{
    avl temp ;
    temp = tree->rchild ;
    tree->rchild = temp->lchild ;
    temp->lchild = tree ;
    tree->balance = max( height( tree->lchild ) , height( tree->rchild) ) + 1 ;
    temp->balance = max( height( temp->rchild ) , tree->balance ) + 1 ;
    return temp ;
}

avl LR( avl tree )//LRå‹çš„ä¸å¹³è¡¡ç»“ç‚¹å¤„è¿›è¡Œå·¦å³åŒæ—‹  
{
    tree->lchild = RR( tree->lchild ) ;  //å¯¹ä¸å¹³è¡¡ç»“ç‚¹çš„å·¦å­©å­å³æ—‹è½¬
    tree =  LL( tree ) ;   //å¯¹ä¸å¹³è¡¡ç»“ç‚¹å¤„å·¦æ—‹è½¬
	return tree ;
}

avl RL( avl tree )
{
    tree->rchild = LL( tree->rchild ) ;  //å¯¹ä¸å¹³è¡¡ç»“ç‚¹çš„å³å­©å­å·¦æ—‹è½¬
    tree =  RR( tree ) ;   //å¯¹ä¸å¹³è¡¡ç»“ç‚¹å¤„å³æ—‹è½¬
	return tree ;
}

int main()
{ 
    avl tree = NULL ;
    char name[ 30 ] ;
    scanf( "%d" , &n ) ; //è¾“å…¥ğŸŒ²çš„ä¸ªæ•°
	getchar();
    for( int i = 0 ; i < n ; i++ )  //å¾ªç¯è¾“å…¥ğŸŒ²çš„åå­—
    {
        gets( name ) ;
        tree = insertt ( name , tree ) ;  //å°†ğŸŒ²æ’å…¥äºŒå‰æ ‘ä¸­  
    }
    InOrder ( tree ) ; //æŒ‰å­—å…¸åºè¾“å‡ºğŸŒ²å’ŒğŸŒ²çš„ä¸ªæ•°
    return 0 ;
}
```
